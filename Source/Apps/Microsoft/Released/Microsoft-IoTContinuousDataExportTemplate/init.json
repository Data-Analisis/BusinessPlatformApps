{
  "Install": {
    "Pages": [
      {
        "architectureDiagram": "dist/Apps/Microsoft/Released/Microsoft-IoTContinuousDataExportTemplate/Web/Images/iot-continuous-data-export.png",
        "displayname": "Getting Started",
        "list1": [
          "$translate(INIT_GETTING_STARTED_AZURE_SUBSCRIPTION)",
          "$translate(INIT_GETTING_STARTED_PBI_DESKTOP)",
          "$translate(INIT_GETTING_STARTED_PBI_PRO)"
        ],
        "list2": [
          "$translate(INIT_GETTING_STARTED_AZURE_FUNCTION_BLOB_STORAGE)",
          "$translate(INIT_GETTING_STARTED_AZURE_DATA_FACTORY)",
          "$translate(INIT_GETTING_STARTED_CONNECT_AS_PBI)"
        ],
        "name": "$SiteCommon$/pages-gallery/getting-started.html",
        "subtitle": "$translate(INIT_IOT_CDE_SUBTITLE)",
        "templateName": "$translate(INIT_IOT_CDE_TITLE)"
      },
      {
        "azureProviders": [
          "Microsoft.EventHub",
          "Microsoft.DataFactory"
        ],
        "defaultLocation": "5",
        "displayname": "Login",
        "name": "$SiteCommon$/pages-gallery/azure-login.html",
        "pricingCalculatorUrl": "$translate(INIT_NEWS_PRICING_CALCULATOR)",
        "pricingCost": "$translate(INIT_IOT_CDE_PRICING_COST)",
        "pricingUrl": "$translate(INIT_IOT_CDE_PRICING_URL)"
      },
      {
        "displayname": "Target",
        "isAzureSql": true,
        "name": "$SiteCommon$/pages-gallery/sql.html",
        "newSqlDatabase": "continuousDataExportDB",
        "showAzureSql": false,
        "showNewSqlOption": true,
        "sqlInstance": "NewSql",
        "subtitle": "$translate(INIT_SQL_SUBTITLE_IOT_CDE)",
        "title": "$translate(INIT_SQL_TITLE)"
      },
      {
        "displayCompletionNotification": false,
        "displayname": "Summary",
        "name": "$SiteCommon$/pages-gallery/summary.html",
        "sendCompletionNotification": false,
        "values": {
          "Subscription": "$(this.MS.DataStore.getJson('SelectedSubscription').DisplayName)",
          "Resource Group": "$(this.MS.DataStore.getValue('SelectedResourceGroup'))",
          "Target Server": "$(this.MS.DataStore.getValue('Server'))",
          "Target Database": "$(this.MS.DataStore.getValue('Database'))",
          "Target Username": "$(this.MS.DataStore.getValue('Username'))"
        }
      },
      {
        "asDatabase": "continuousDataExportDB",
        "datastoreEntriesToValidate": [
          "AzureToken",
          "SqlConnectionString"
        ],
        "displayname": "Deploy",
        "DoNotWait": "$save('1')",
        "filename": "$save('IoT-Continuous-Data-Export-Template.pbix')",
        "finishedActionName": "Microsoft-GetHistoricalData",
        "name": "$SiteCommon$/pages-gallery/progress.html",
        "showCounts": true,
        "successMessage": "$translate(INIT_AAL_DOWNLOAD)",
        "successMessage2": "$translate(INIT_AAL_DOWNLOAD_2)",
        "targetSchema": "bpst_aal",
        "uniqueId": "$save(this.MS.UtilityService.getUniqueId(10))"
      }
    ],

    "Actions": [
      {
        "displayname": "$translate(INIT_ACTION_DEPLOYING_SQL_SCRIPTS)",
        "name": "Microsoft-DeploySQLScripts",
        "SqlServerIndex": "0",
        "SqlScriptsFolder": "Database"
      },
      {
        "AzureArmFile": "Service/ARM/functions.json",
        "AzureArmParameters": {
          "sku": "Standard",
          "workerSize": "Small",
          "blobStorageConnectionString": "DefaultEndpointsProtocol=https;AccountName=jeffscratch;AccountKey=QRYrElr9AnKXNvP7MXUHA4E0IjkyeBU3n64jKjyZcOjkE8MDNSH6BJ2sOPgTrOpfErSPUIf6xIrrO03I9uD4Lg=="
        },
        "AzureArmParametersUniquePrefix": {
          "siteName": "-continuousdataexport",
          "functionStorage": "function"
        },
        "displayname": "$translate(INIT_ACTION_CREATING_FUNCTION)",
        "name": "Microsoft-DeployIoTCDEAzureFunction"
      },
      {
        "ZipFile": "Service/Data/functions.zip",
        "displayname": "$translate(INIT_ACTION_GETTING_EVENTHUB_KEYS)",
        "name": "Microsoft-DeployIoTCDEFunctionCode"
      },
      {
        "displayname": "$translate(INIT_ACTION_EXPORT_ACTIVITY_LOG)",
        "name": "Microsoft-ExportActivityLogToEventHub"
      },
      {
        "AzureArmFile": "Service/ARM/StreamAnalytics.json",
        "AzureArmParametersUnique": {
          "nameStreamAnalyticsJob": "bpst-al-saj-"
        },
        "displayname": "$translate(INIT_ACTION_CREATING_STREAM_ANALYTICS_JOB)",
        "name": "Microsoft-DeployAzureArmTemplate"
      },
      {
        "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_INPUT_EVENTHUB)",
        "inputSerialization": "Json",
        "name": "Microsoft-AddStreamAnalyticsInputEventHub",
        "nameStreamAnalyticsInputEventHub": "EventHubInput"
      },
      {
        "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_OUTPUT_SQL)",
        "name": "Microsoft-AddStreamAnalyticsOutputSql",
        "streamAnalyticsOutputSql": {
          "name": "ServiceHealthOutput",
          "table": "bpst_aal.ServiceHealthData"
        }
      },
      {
        "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_OUTPUT_SQL)",
        "name": "Microsoft-AddStreamAnalyticsOutputSql",
        "streamAnalyticsOutputSql": {
          "name": "AdministrativeOutput",
          "table": "bpst_aal.AdministrativeData"
        }
      },
      {
        "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_JSON_HELPER)",
        "name": "Microsoft-SetStreamAnalyticsJSONFunction"
      },
      {
        "displayname": "$translate(INIT_ACTION_CONFIGURING_STREAM_ANALYTICS_QUERY)",
        "name": "Microsoft-SetStreamAnalyticsQuery"
      },
      {
        "displayname": "$translate(INIT_ACTION_VERIFY_EVENT_HUB)",
        "name": "Microsoft-VerifyLogProfileEventHub"
      },
      {
        "displayname": "$translate(INIT_ACTION_DEPLOYING_STREAM_ANALYTICS)",
        "name": "Microsoft-ToggleStreamAnalytics"
      },
      {
        "displayname": "$translate(INIT_ACTION_GET_HISTORICAL_ACTIVITY_LOG_DATA)",
        "name": "Microsoft-GetDataPullStatus",
        "FinishedActionName": "Microsoft-GetHistoricalData",
        "TargetSchema": "bpst_aal"
      }
    ]
  }
}